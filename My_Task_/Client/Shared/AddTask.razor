@using My_Task_.Shared;
@implements IDisposable;
@inject ShowAddTask UpdateShow;
@inject CreateTask createTask;


@if (UpdateShow.AddTaskState)
{
    <div class="maintain">
        <div class=" add-container">
            <div class="field-name big"><p>CREATE TASK</p></div>
            <div class="close-add-item" @onclick="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30">
                    <g id="Group_193" data-name="Group 193" transform="translate(-1671 -1)">
                        <g id="Path_81" data-name="Path 81" transform="translate(1671 1)" fill="#bdbebf">
                            <path d="M 22 28 L 8 28 C 4.691589832305908 28 2 25.30841064453125 2 22 L 2 8 C 2 4.691589832305908 4.691589832305908 2 8 2 L 22 2 C 25.30841064453125 2 28 4.691589832305908 28 8 L 28 22 C 28 25.30841064453125 25.30841064453125 28 22 28 Z" stroke="none" />
                            <path d="M 8 4 C 5.794389724731445 4 4 5.794389724731445 4 8 L 4 22 C 4 24.20561027526855 5.794389724731445 26 8 26 L 22 26 C 24.20561027526855 26 26 24.20561027526855 26 22 L 26 8 C 26 5.794389724731445 24.20561027526855 4 22 4 L 8 4 M 8 0 L 22 0 C 26.41827964782715 0 30 3.581720352172852 30 8 L 30 22 C 30 26.41827964782715 26.41827964782715 30 22 30 L 8 30 C 3.581720352172852 30 0 26.41827964782715 0 22 L 0 8 C 0 3.581720352172852 3.581720352172852 0 8 0 Z" stroke="none" fill="transparent" />
                        </g>
                        <g id="Close" transform="translate(1680.5 11)">
                            <line id="Line_34" data-name="Line 34" x2="10" y2="10" fill="none" stroke="#f5f5f5" stroke-linecap="round" stroke-width="3" />
                            <line id="Line_35" data-name="Line 35" x2="10" y2="10" transform="translate(0 10) rotate(-90)" fill="none" stroke="#f5f5f5" stroke-linecap="round" stroke-width="3" />
                        </g>
                    </g>
                </svg>
            </div>
            <form class="add-category-container">
                <div class="container add-parent-container">


                    <div class="field-name-small @HideCategory"><p>Task Category</p></div>
                    <div class="cat-group group-box @HideCategory">
                            <input type="text" required @bind="@TaskCat" class="box" />
                            <div class="selector"></div>
                        </div>

                        <div class="field-name-small hide-parent @ShowParent"><p>Task Parent</p></div>
                    <div class="cat-group group-box hide-parent @ShowParent">
                            <input type="text" @bind="@TaskP" class="box" disabled/>
                            <div class="selector"></div>
                        </div>


                        <div class="field-name-small"><p>Task name</p></div>
                        <input type="text" class="box" required @bind="@TaskName" />
                        <div class="selector"></div>


                        <div class="field-name-small"><p>Task Description</p></div>
                        <textarea @bind="@TaskDescription" required class="box description" cols="30" />
                        <div class="selector"></div>

                        <div class="date-container">
                            <label class="field-name-small">
                                Start Date
                            <input type="date" @bind="@StartDate" />
                            </label >
                            <label class="field-name-small">
                                Deadline
                            <input type="date" @bind="@EndDate" />
                            </label>
                        </div>
                        <div class="subtask-option @HideSubtask">Subtasks
                        <div class="subtask-option-inner" @onclick="ChangeClick">
                            <div class="inner-circle @ClickClass"></div>
                            </div>
                        No Subtasks
                        </div>

                    <div class="time-container date-container @ShrinkHeight" id="@TimeClass">
                        <label class="field-name-small" id="@Shrink">
                            Start time
                            <div class="input-container" id="@Shrink">
                                <input type="time" id="@Shrink" @bind="@TaskTimeStart" />
                            </div>
                        </label>
                        <label class="field-name-small" id="@Shrink">
                            End time
                            <div class="input-container" >
                                <input type="time" id="@Shrink" @bind="@TaskTimeEnd" />
                            </div>
                        </label>
                    </div>
                </div>
                    <div class="container add-child-continer parent">
                    <div class="container child-slide-over add-child-continer" id="@ActivateSubTask"></div>
                        <div class="viewbox child">
                            <ol>
                                @if (createTask.NewContent.Count != 0)
                                {
                                    @foreach (TaskItem Item in createTask.NewContent)
                                    {
                                        @if (Item.TaskItemParent == null)
                                        {

                                        <li class="parent adable-item first"><div class="pre-box"></div><p>@Item.TaskItemName</p></li>
                                        }
                                        else
                                        {
                                            <li class="mother-box">
                                            <li class="parent-child-guide"></li>
                                            <li class="children adable-item"><div class="pre-box"></div><p>@Item.TaskItemName</p></li>
                                            <li class="remove-child">

                                            </li>
                                            </li>
                                        }

                                    }
                                }
                            </ol>
                        </div>
                        <div class="viewbox button" @onclick="UpdateNewData">Add Item</div>
                        <div class="button done-button">
                            @error
                        </div>
                    </div>
                   
            </form>
        </div>
    </div>
}
@code{
    private bool Show = false;
    [Parameter] public string? TaskName { get; set; }
    [Parameter] public string? TaskCat { get; set; }
    [Parameter] public string? TaskDescription { get; set; }
    [Parameter] public string TaskP { get; set; } = null;

    [Parameter] public DateOnly? StartDate { get; set; }

    [Parameter] public DateOnly? EndDate { get; set; }

    [Parameter] public TimeOnly? TaskTimeStart { get; set; }

    [Parameter] public TimeOnly? TaskTimeEnd { get; set; }

    [Parameter] public int NoSubtask { get; set; }
    [Parameter] public bool IsCompeted { get; set; } = false;
    [Parameter] public bool TAskItemRepeat { get; set; }
    public void Close() => UpdateShow.Update();
}